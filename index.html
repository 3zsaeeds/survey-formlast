<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>استبيان الارتباط الوظيفي - مركز الإحالات الطبية</title>
<style>
body {
  background-color:#C3BE9D;
  color:#222;
  margin:0;
  padding:0;
  direction:rtl;
  font-family:'Sakalla Majala',sans-serif;
}
header {
  background-color:#2DA98B;
  color:white;
  text-align:center;
  padding:25px;
  font-family:'GE SS Unique Bold',sans-serif;
  font-size:26px;
  border-bottom:5px solid #73B7C4;
}
section {
  margin:30px auto;
  background:white;
  padding:30px;
  border-radius:14px;
  max-width:950px;
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
}
.question {
  margin-bottom:25px;
  padding-bottom:15px;
  border-bottom:1px solid #eee;
}
.options {
  margin-top:10px;
}
.options label {
  display:block;
  margin-bottom:5px;
  cursor:pointer;
  background:#f5f5f5;
  padding:8px 10px;
  border-radius:6px;
  transition:0.2s;
}
.options label:hover {
  background:#73B7C4;
  color:white;
}
textarea {
  width:100%;
  height:90px;
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
  resize:vertical;
}
.submit-container {
  text-align:center;
  margin-top:30px;
}
.status-message {
  display:none;
  font-size:15px;
  color:#555;
  margin-bottom:10px;
}
button {
  background:linear-gradient(90deg,#2DA98B,#73B7C4);
  color:white;
  border:none;
  padding:15px 40px;
  border-radius:50px;
  font-size:18px;
  cursor:pointer;
  font-family:'GE SS Unique Bold',sans-serif;
  transition:0.3s;
}
button:hover {
  transform:scale(1.05);
  background:linear-gradient(90deg,#73B7C4,#2DA98B);
}
.progress-bar {
  width:0%;
  height:8px;
  background-color:#2DA98B;
  border-radius:5px;
  margin-top:10px;
  transition:width 0.5s;
}
footer {
  text-align:center;
  font-size:14px;
  color:#555;
  padding:20px;
}
</style>
</head>
<body>
<header>استبيان الارتباط الوظيفي لموظفي مركز الإحالات الطبية</header>

<section>
<p>يهدف هذا الاستبيان إلى التعرف على مستوى الارتباط والرضا الوظيفي لدى الموظفين في مركز الإحالات الطبية لتحسين بيئة العمل وتطوير الخدمات. جميع الإجابات سرية وتستخدم لأغراض التحسين فقط.</p>

<form id="surveyForm">
<div id="questions"></div>

<div class="question">
  <label>برأيك، ما هي التحديثات والمواضيع التي ترغب بأن يقوم المركز بطرحها عند التواصل في المستقبل والتي تعتقد بأنها ستكون ذات أثر إيجابي؟</label>
  <textarea name="التحديثات المستقبلية"></textarea>
</div>
<div class="question">
  <label>هل لديك أي اقتراحات أو ملاحظات أخرى ترغب في مشاركتها حول تحسين وسائل التواصل في المركز؟</label>
  <textarea name="اقتراحات أخرى"></textarea>
</div>

<div class="submit-container">
  <div class="status-message" id="statusMsg">برجاء عدم إغلاق الصفحة لحين انتهاء إرسال الإجابات...</div>
  <button type="submit">إرسال الإجابات</button>
  <div class="progress-bar" id="progressBar"></div>
</div>
</form>
</section>

<footer>© 2025 مركز الإحالات الطبية - إدارة الموارد البشرية - جميع الحقوق محفوظة</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby33YC6ALniZKykXorzFM-voKd2nrVd1L6A-Wxfr2mBwWSzBQOvitWokeUGACLV7u0e/exec";
const form = document.getElementById('surveyForm');
const progressBar = document.getElementById('progressBar');
const statusMsg = document.getElementById('statusMsg');

const questions = [
"أستفيد من الخدمات المقدمة من إدارات المركز",
"أتلقى معلومات كافية ومهمة من المركز أو إدارتي بشكل منتظم",
"يتم تشجيعي على المشاركة في اجتماعات وورش العمل والفعاليات في المركز",
"أعتقد أن هناك فرصًا كافية للتواصل وتبادل الأفكار بين الموظفين في المركز",
"أشعر أن القنوات المتاحة للتواصل تساهم في تحسين فهمي لرؤية وأهداف المركز",
"أشعر بأنني مشارك في وضع أهداف العمل مع إدارتي",
"يتم توفير فرص وقنوات لتقديم الملاحظات والاقتراحات بشأن تحسين التواصل في المركز",
"أشعر بأن إدارتي تستجيب لاقتراحات الموظفين بشكل إيجابي",
"أشعر بأن المركز وإدارتي تتعامل مع شكاوى الموظفين بشكل فعال",
"أعتقد أن الفريق القيادي في المركز يعمل على تحقيق الرؤية والأهداف المحددة",
"أشعر أن الفريق القيادي يشجع الابتكار والإبداع في المركز",
"أشعر أن الفريق القيادي يتعامل معي ومع زملائي بعدالة واحترام",
"أشعر أن الفريق القيادي يساعد في تنمية مهاراتي الشخصية والمهنية",
"يتم شرح الوصف الوظيفي للموظف عن الأداء والأهداف بكل وضوح",
"أعتقد أن عملية تقديم الملاحظات وتقييم الأداء للموظفين في المركز تقدم بشكل فعال",
"أعتقد أن أعباء العمل توزع على الموظفين بشكل عادل",
"يوفر المركز فرصًا لتطوير الموظفين ونموهم",
"يدير المركز التغيير بشكل فعال مما يسهل على الموظفين التكيف مع التغيير",
"يتم إشراك الموظفين بشكل كاف في عملية التغيير",
"يوفر المركز الدعم والموارد اللازمة خلال فترات التغيير",
"يوفر المركز برامج تدريبية وتطويرية للموظفين",
"يشجع المركز الموظفين على اكتساب مهارات جديدة والتعلم المستمر",
"أرى أن برامج التدريب والتطوير التي يقدمها المركز فعالة",
"أشعر بالاحترام من قبل فريقي والمركز",
"يمتلك المركز سياسة للتنوع والشمولية",
"عمل المركز يؤثر بشكل إيجابي على الموظفين",
"يمتلك المركز بيئة عمل آمنة لجميع الموظفين",
"يوجد ثقافة عمل جماعية وتعاونية داخل المركز",
"أشعر بالرضا عن بيئة العمل وظروف العمل في المركز",
"أشعر بالمشاركة والتعاون بعملية صنع القرار في المركز",
"يتبع المركز سياسات تعزز التوازن بين العمل والحياة الشخصية للموظفين",
"هل تم توفير معلومات واضحة وكافية حول السياسات والإجراءات الخاصة بالموظفين من قبل إدارة الموارد البشرية؟",
"كيف تقيم جودة الدعم والمساعدة المقدمة فيما يتعلق بالخدمات المقدمة من قبل إدارة الموارد البشرية؟",
"هل يتم التعامل مع مشاكلك واستفساراتك بشكل سريع وفعال؟"
];

const container = document.getElementById('questions');
questions.forEach(q => {
  const div = document.createElement('div');
  div.className = 'question';
  div.innerHTML = `
    <label>${q}</label>
    <div class="options">
      <label><input type="radio" name="${q}" value="أوافق بشدة" required> أوافق بشدة</label>
      <label><input type="radio" name="${q}" value="أوافق"> أوافق</label>
      <label><input type="radio" name="${q}" value="محايد"> محايد</label>
      <label><input type="radio" name="${q}" value="أعارض"> أعارض</label>
      <label><input type="radio" name="${q}" value="أعارض بشدة"> أعارض بشدة</label>
    </div>
  `;
  container.appendChild(div);
});

form.addEventListener('submit', e => {
  e.preventDefault();
  statusMsg.style.display = 'block';
  progressBar.style.width = '30%';
  const data = new FormData(form);
  const params = new URLSearchParams();
  for (const [k,v] of data.entries()) params.append(k,v);
  fetch(WEB_APP_URL,{method:'POST',body:params})
  .then(r=>r.text())
  .then(()=>{
    progressBar.style.width='100%';
    alert('✅ تم إرسال الإجابات بنجاح، شكرًا لمشاركتك!');
    form.reset();
    statusMsg.style.display='none';
    setTimeout(()=>progressBar.style.width='0%',1500);
  })
  .catch(err=>{
    alert('⚠️ حدث خطأ أثناء الإرسال: '+err.message);
    statusMsg.style.display='none';
  });
});
</script>
</body>
</html>
