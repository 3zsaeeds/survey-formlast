<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>استبيان الارتباط الوظيفي - مركز الإحالات الطبية</title>

<style>
@font-face {
  font-family: 'GESSS';
  src: url('./ArbFONTS-GE_SS_Unique_Bold_5.otf') format('opentype');
}
@font-face {
  font-family: 'SakallaMajala';
  src: url('./majalla.ttf') format('truetype');
}

body {
  background-color: #C3BE9D;
  color: #222;
  margin: 0;
  padding: 0;
  direction: rtl;
  font-family: 'SakallaMajala', sans-serif;
}

header {
  background-color: #2DA98B;
  color: white;
  text-align: center;
  padding: 25px;
  font-family: 'GESSS', sans-serif;
  font-size: 26px;
  border-bottom: 5px solid #73B7C4;
}

section {
  margin: 30px auto;
  background: white;
  padding: 30px;
  border-radius: 14px;
  max-width: 950px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

h2 {
  color: #2DA98B;
  font-family: 'GESSS', sans-serif;
  border-right: 5px solid #73B7C4;
  padding-right: 10px;
  margin-top: 40px;
}

label {
  display: block;
  margin-bottom: 10px;
  font-weight: bold;
}

.question {
  margin-bottom: 25px;
  padding-bottom: 15px;
  border-bottom: 1px solid #eee;
}

.scale {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  font-size: 14px;
  margin-top: 10px;
  text-align: center;
}

.scale label {
  background: #f5f7fa;
  border: 1px solid #ccc;
  border-radius: 6px;
  padding: 10px;
  transition: 0.2s;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.scale label:hover {
  background-color: #73B7C4;
  color: white;
}

.scale input[type="radio"] {
  margin-left: 5px;
  accent-color: #2DA98B;
  transform: scale(1.1);
}

textarea {
  width: 100%;
  height: 100px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  resize: vertical;
  font-family: 'SakallaMajala';
}

.submit-container {
  text-align: center;
  margin-top: 30px;
}

#loadingMessage {
  display: none;
  color: #2DA98B;
  font-weight: bold;
  margin-bottom: 10px;
  font-family: 'GESSS';
}

button {
  background: linear-gradient(90deg, #2DA98B, #73B7C4);
  color: white;
  border: none;
  padding: 15px 40px;
  border-radius: 50px;
  font-size: 18px;
  cursor: pointer;
  font-family: 'GESSS', sans-serif;
  transition: 0.3s;
}

button:hover {
  transform: scale(1.05);
  background: linear-gradient(90deg, #73B7C4, #2DA98B);
}

.progress-bar {
  width: 0%;
  height: 8px;
  background-color: #2DA98B;
  border-radius: 5px;
  margin-top: 10px;
  transition: width 0.5s;
}

footer {
  text-align: center;
  font-size: 14px;
  color: #555;
  padding: 20px;
  font-family: 'SakallaMajala';
}
</style>
</head>

<body>
<header>استبيان الارتباط الوظيفي لموظفي مركز الإحالات الطبية</header>

<section>
  <p>يهدف هذا الاستبيان إلى التعرف على مستوى الارتباط والرضا الوظيفي لدى الموظفين في مركز الإحالات الطبية لتحسين بيئة العمل وتطوير الخدمات. جميع الإجابات سرية وتستخدم لأغراض التحسين فقط.</p>

  <form id="surveyForm">
    <div id="questions"></div>

    <h2>الأسئلة المفتوحة</h2>
    <div class="question">
      <label>برأيك، ما هي التحديثات والمواضيع التي ترغب بأن يقوم المركز بطرحها عند التواصل في المستقبل والتي تعتقد بأنها ستكون ذات أثر إيجابي؟</label>
      <textarea name="برأيك، ما هي التحديثات والمواضيع التي ترغب بأن يقوم المركز بطرحها عند التواصل في المستقبل والتي تعتقد بأنها ستكون ذات أثر إيجابي؟"></textarea>
    </div>
    <div class="question">
      <label>هل لديك أي اقتراحات أو ملاحظات أخرى ترغب في مشاركتها حول تحسين وسائل التواصل في المركز؟</label>
      <textarea name="هل لديك أي اقتراحات أو ملاحظات أخرى ترغب في مشاركتها حول تحسين وسائل التواصل في المركز؟"></textarea>
    </div>

    <div class="submit-container">
      <div id="loadingMessage">🔄 برجاء عدم إغلاق الصفحة لحين إرسال الإجابات...</div>
      <button type="submit" id="submitBtn">إرسال الإجابات</button>
      <div class="progress-bar" id="progressBar"></div>
    </div>
  </form>
</section>

<footer>© 2025 مركز الإحالات الطبية - إدارة الموارد البشرية - جميع الحقوق محفوظة</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby33YC6ALniZKykXorzFM-voKd2nrVd1L6A-Wxfr2mBwWSzBQOvitWokeUGACLV7u0e/exec";

const questions = [
  "أستفيد من الخدمات المقدمة من إدارات المركز",
  "أتلقى معلومات كافية ومهمة من المركز أو إدارتي بشكل منتظم",
  "يتم تشجيعي على المشاركة في اجتماعات وورش العمل والفعاليات في المركز",
  "أعتقد أن هناك فرصًا كافية للتواصل وتبادل الأفكار بين الموظفين في المركز",
  "أشعر أن القنوات المتاحة للتواصل تساهم في تحسين فهمي لرؤية وأهداف المركز",
  "أشعر بأنني مشارك في وضع أهداف العمل مع إدارتي",
  "يتم توفير فرص وقنوات لتقديم الملاحظات والاقتراحات بشأن تحسين التواصل في المركز",
  "أشعر بأن إدارتي تستجيب لاقتراحات الموظفين بشكل إيجابي",
  "أشعر بأن المركز وإدارتي تتعامل مع شكاوى الموظفين بشكل فعال",
  "أعتقد أن الفريق القيادي في المركز يعمل على تحقيق الرؤية والأهداف المحددة",
  "أشعر أن الفريق القيادي يشجع الابتكار والإبداع في المركز",
  "أشعر أن الفريق القيادي يتعامل معي ومع زملائي بعدالة واحترام",
  "أشعر أن الفريق القيادي يساعد في تنمية مهاراتي الشخصية والمهنية",
  "يتم شرح الوصف الوظيفي للموظف عن الأداء والأهداف بكل وضوح",
  "أعتقد أن عملية تقديم الملاحظات وتقييم الأداء للموظفين في المركز تقدم بشكل فعال",
  "أعتقد أن أعباء العمل توزع على الموظفين بشكل عادل",
  "يوفر المركز فرصًا لتطوير الموظفين ونموهم",
  "يدير المركز التغيير بشكل فعال مما يسهل على الموظفين التكيف مع التغيير",
  "يتم إشراك الموظفين بشكل كاف في عملية التغيير",
  "يوفر المركز الدعم والموارد اللازمة خلال فترات التغيير",
  "يوفر المركز برامج تدريبية وتطويرية للموظفين",
  "يشجع المركز الموظفين على اكتساب مهارات جديدة والتعلم المستمر",
  "أرى أن برامج التدريب والتطوير التي يقدمها المركز فعالة",
  "أشعر بالاحترام من قبل فريقي والمركز",
  "يمتلك المركز سياسة للتنوع والشمولية",
  "عمل المركز يؤثر بشكل إيجابي على الموظفين",
  "يمتلك المركز بيئة عمل آمنة لجميع الموظفين",
  "يوجد ثقافة عمل جماعية وتعاونية داخل المركز",
  "أشعر بالرضا عن بيئة العمل وظروف العمل في المركز",
  "أشعر بالمشاركة والتعاون بعملية صنع القرار في المركز",
  "يتبع المركز سياسات تعزز التوازن بين العمل والحياة الشخصية للموظفين",
  "هل تم توفير معلومات واضحة وكافية حول السياسات والإجراءات الخاصة بالموظفين من قبل إدارة الموارد البشرية؟",
  "كيف تقيم جودة الدعم والمساعدة المقدمة فيما يتعلق بالخدمات المقدمة من قبل إدارة الموارد البشرية؟",
  "هل يتم التعامل مع مشاكلك واستفساراتك بشكل سريع وفعال؟"
];

const scaleOptions = ["أوافق بشدة","أوافق","محايد","أعارض","أعارض بشدة"];
const container = document.getElementById('questions');

questions.forEach(q => {
  const div = document.createElement('div');
  div.className = 'question';
  div.innerHTML = `<label>${q}</label><div class="scale">` +
    scaleOptions.map(opt =>
      `<label><input type="radio" name="${q}" value="${opt}" required> ${opt}</label>`
    ).join('') +
    `</div>`;
  container.appendChild(div);
});

const form = document.getElementById('surveyForm');
const btn = document.getElementById('submitBtn');
const loadingMessage = document.getElementById('loadingMessage');
const progressBar = document.getElementById('progressBar');

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  for (const q of questions) {
    const group = document.getElementsByName(q);
    if (![...group].some(r => r.checked)) {
      alert('⚠️ الرجاء الإجابة على جميع الأسئلة قبل الإرسال.');
      return;
    }
  }

  btn.disabled = true;
  loadingMessage.style.display = 'block';
  progressBar.style.width = '40%';

  const fd = new FormData(form);
  fd.append('التاريخ والوقت', new Date().toLocaleString('sv-SE'));

  const params = new URLSearchParams();
  for (const [k, v] of fd.entries()) params.append(k, v);

  try {
    const res = await fetch(WEB_APP_URL, { method: 'POST', body: params });
    const text = await res.text();

    if (res.ok && (text.toUpperCase().includes('OK') || text.toLowerCase().includes('success'))) {
      progressBar.style.width = '100%';
      alert('✅ تم إرسال الإجابات بنجاح، شكرًا لمشاركتك!');
      form.reset();
    } else {
      throw new Error(text || 'خطأ أثناء الإرسال');
    }
  } catch (err) {
    alert('⚠️ حدث خطأ أثناء الإرسال: ' + err.message);
  } finally {
    btn.disabled = false;
    loadingMessage.style.display = 'none';
    setTimeout(() => progressBar.style.width = '0%', 1200);
  }
});
</script>
</body>
</html>
